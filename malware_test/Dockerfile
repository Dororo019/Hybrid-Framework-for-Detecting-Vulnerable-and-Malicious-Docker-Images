# TRIGGER 1: Trivy (Vulnerabilities)
# We are using an old Alpine version (3.11) which has known CVEs
FROM alpine:3.11

# TRIGGER 2: ClamAV & YARA (Malware Signatures)
# We are creating a file containing the EICAR test string.
# It is harmless, but antivirus software is programmed to detect it as a virus.
RUN echo 'X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*' > /tmp/eicar.com.txt

# Setup the runtime triggers
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]

