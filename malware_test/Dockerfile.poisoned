FROM alpine:latest
# First we'll be creating a writable directory first
RUN mkdir -p /tmp/malware
# then add the EICAR test string that is harmless, but all AV engines can detect it
RUN echo 'X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*' > /tmp/malware/eicar.txt
# also let's add a script that triggers Falco alerts
RUN echo '#!/bin/sh' > /tmp/start.sh && \
    echo 'echo "[*] Starting malicious container..."' >> /tmp/start.sh && \
    echo 'while true; do' >> /tmp/start.sh && \
    echo '  echo "Mining..."' >> /tmp/start.sh && \
    echo '  sleep 1' >> /tmp/start.sh && \
    echo 'done' >> /tmp/start.sh && \
    chmod +x /tmp/start.sh
CMD ["/bin/sh", "/tmp/start.sh"]

